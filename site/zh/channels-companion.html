<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0f1419">
  <meta name="description" content="HomeClaw 渠道与伴侣应用：支持的渠道、远程访问（Tailscale、Cloudflare Tunnel、Pinggy、SSH）、伴侣应用在 Mac、Windows、iPhone、Android 上的使用。">
  <title>渠道与伴侣应用 — HomeClaw</title>
  <link rel="icon" type="image/png" href="../assets/homeclaw-logo.png">
  <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
  <header class="site-nav-wrap">
  <nav class="site-nav" aria-label="主导航">
    <div class="site-nav-inner">
      <a href="index.html" class="site-logo-wrap">
        <img src="../assets/homeclaw-logo.png" alt="HomeClaw" class="site-logo-img" width="32" height="32">
        <span>HomeClaw</span>
      </a>
      <div class="site-links">
        <a href="index.html">首页</a>
        <a href="docs.html#quickstart">快速开始</a>
        <a href="docs.html#deploy-cloud">部署到云</a>
        <a href="channels-companion.html">渠道与伴侣</a>
        <a href="plugins-skills.html">插件与技能</a>
        <a href="core-config.html">Core 配置</a>
        <a href="docs.html">文档</a>
        <a href="https://github.com/allenpeng0705/HomeClaw" target="_blank" rel="noopener"><svg class="site-nav-icon site-nav-icon-github" aria-hidden="true" width="18" height="18" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg> GitHub</a>
        <a href="https://allenpeng0705.github.io/HomeClaw/" target="_blank" rel="noopener">完整文档</a>
        <span class="lang-switch"><a href="../en/channels-companion.html">EN</a> | 中文</span>
      </div>
    </div>
  </nav>
  </header>

  <main class="container doc-content">
    <div class="doc-intro">
      <h1>渠道与伴侣应用</h1>
      <p class="lead">通过 WebChat、Telegram、Discord、伴侣应用等与 HomeClaw 对话。均使用同一 Core 与记忆。当 Core 在家而你在其他网络时，可使用远程访问。</p>
    </div>

    <nav class="doc-toc" aria-label="本页导航">
      <p class="doc-toc-title">本页导航</p>
      <ul>
        <li><a href="#supported-channels">支持的渠道</a></li>
        <li><a href="#remote-access">远程访问（渠道与客户端）</a></li>
        <li><a href="#companion-platforms">伴侣应用 — 平台与使用</a></li>
        <li><a href="#companion-remote">伴侣应用远程访问</a></li>
      </ul>
    </nav>

    <section class="doc-section doc-section-no-img" id="supported-channels">
      <div class="doc-section-body">
        <h2>支持的渠道</h2>
        <p>渠道是连接 Core 的独立进程。先启动 Core，再运行一个或多个渠道：<code>python -m channels.run &lt;name&gt;</code>。在 <strong>channels/.env</strong> 中设置 Core 连接（CORE_URL 或 core_host、core_port）。在 <strong>config/user.yml</strong> 的 <code>im:</code> 下添加用户（如 <code>telegram_123</code>、<code>discord_456</code>）以允许其对话。</p>
        <ul class="channel-list">
          <li><strong>CLI</strong> — 内置：<code>python -m main start</code>（Core + 内置聊天）。</li>
          <li><strong>WebChat</strong> — 浏览器 WebSocket 界面：<code>python -m channels.run webchat</code> → http://localhost:8014。</li>
          <li><strong>Telegram、Discord、Slack</strong> — 入站机器人：<code>python -m channels.run telegram</code>（及 discord、slack）。在 <code>channels/.env</code> 中设置机器人令牌。</li>
          <li><strong>Email、Matrix、Tinode、WeChat、WhatsApp</strong> — 完整渠道：<code>python -m channels.run &lt;name&gt;</code>。见 <code>channels/README.md</code>。</li>
          <li><strong>Google Chat、Teams、飞书、钉钉</strong> — HTTP/Webhook：运行对应渠道并在平台配置。</li>
          <li><strong>Webhook</strong> — 任意机器人可向 Core <code>/inbound</code> 发送 POST；当 Core 无法公网访问时可用作中继。</li>
        </ul>
      </div>
    </section>

    <section class="doc-section doc-section-no-img" id="remote-access">
      <div class="doc-section-body">
        <h2>远程访问（渠道与客户端）</h2>
        <p>当 Core 在家运行而你在其他网络（如手机蜂窝）使用渠道或伴侣应用时，需暴露 Core 以便客户端访问。应用与渠道仅需 <strong>Core URL</strong> 及可选的 <strong>API Key</strong> — 应用内不包含 Tailscale 或 Cloudflare；由你选择如何暴露 Core，然后在客户端设置该 URL。</p>

        <h3>可选方案</h3>
        <table class="doc-table">
          <thead>
            <tr><th>方式</th><th>谁能访问 Core</th><th>适用场景</th></tr>
          </thead>
          <tbody>
            <tr><td><strong>Tailscale（tailnet）</strong></td><td>仅你 Tailscale 网络内的设备</td><td>家庭 + 你的设备（手机、笔记本）；私网，无需公网暴露。</td></tr>
            <tr><td><strong>Tailscale Funnel</strong></td><td>拥有 URL 的任何人（公网 HTTPS）</td><td>Webhook、机器人；需配合强认证。</td></tr>
            <tr><td><strong>Cloudflare Tunnel</strong></td><td>拥有隧道 URL 的任何人（公网 HTTPS）</td><td>简单公网 URL；配合 Core <code>auth_enabled</code> 使用。</td></tr>
            <tr><td><strong>Pinggy</strong></td><td>拥有 Pinggy URL 的任何人（公网 HTTPS）</td><td>零配置隧道，类似 ngrok/Cloudflare。在 Core 主机上运行隧道；将 HTTPS URL 设为 Core URL。</td></tr>
            <tr><td><strong>SSH 隧道</strong></td><td>你，从运行隧道的机器</td><td>开发；通过 SSH 将本地端口转发到 Core（如 <code>ssh -L 9000:127.0.0.1:9000 user@core-host</code>）。</td></tr>
          </tbody>
        </table>

        <h3>Tailscale</h3>
        <p>在 Core 主机与设备上安装；使用 Tailscale IP（如 <code>http://100.x.x.x:9000</code>）作为 Core URL。私网；无需公网端口。可选：<code>tailscale serve https / http://127.0.0.1:9000</code> 获得 HTTPS URL。</p>

        <h3>Cloudflare Tunnel</h3>
        <p>运行 <code>cloudflared tunnel --url http://127.0.0.1:9000</code>；将生成的 HTTPS URL（如 <code>https://xxx.trycloudflare.com</code>）设为 Core URL。在 core.yml 中启用 <code>auth_enabled</code> 与 <code>auth_api_key</code>。</p>

        <h3>Pinggy</h3>
        <p>类似 ngrok：在 Core 主机上运行隧道（见 <a href="https://pinggy.io/" target="_blank" rel="noopener">pinggy.io</a>）；会得到公网 HTTPS URL。将该 URL 设为 Core URL，并在 core.yml 中启用 <code>auth_enabled</code>。</p>

        <h3>SSH 隧道</h3>
        <p>在你的笔记本上：<code>ssh -L 9000:127.0.0.1:9000 user@core-host</code>。然后在笔记本上将 Core URL 设为 <code>http://127.0.0.1:9000</code>；流量通过 SSH 转发到 Core。适合开发；不适合手机/伴侣应用在蜂窝网络下使用。</p>

        <p>与 Core 同机运行的渠道无需隧道；若 WebChat/Telegram/Discord 在<strong>远程</strong>服务器上，在 <code>channels/.env</code> 中将 CORE_URL 指向你的 Core（Tailscale IP 或隧道 URL），若 Core 启用了认证则设置 CORE_API_KEY。</p>
      </div>
    </section>

    <section class="doc-section doc-section-no-img" id="companion-platforms">
      <div class="doc-section-body">
        <h2>伴侣应用 — 平台与使用</h2>
        <p><strong>HomeClaw 伴侣应用</strong>是基于 Flutter 的 <strong>Mac、Windows、iPhone、Android</strong> 客户端。一个应用：聊天、语音、附件及<strong>管理 Core</strong>（在应用中编辑 core.yml、user.yml）。</p>
        <ul>
          <li><strong>获取方式：</strong>从 <code>clients/homeclaw_companion/</code> 构建（见仓库 README）。</li>
          <li><strong>Mac / Windows（与 Core 同机）：</strong>将 <strong>Core URL</strong> 设为 <code>http://127.0.0.1:9000</code>。在 user.yml 或通过「管理 Core」→ 用户添加你的用户。</li>
          <li><strong>Mac / Windows（同 Wi‑Fi）：</strong>将 Core URL 设为本机 LAN IP（如 <code>http://192.168.1.10:9000</code>）。</li>
          <li><strong>iPhone / Android（外出）：</strong>将 Core URL 设为你的 <strong>Tailscale IP</strong>、<strong>Cloudflare Tunnel URL</strong> 或 <strong>Pinggy URL</strong>。若 Core 启用了 <code>auth_enabled: true</code>，在应用设置中填写相同的 <strong>API Key</strong>。</li>
        </ul>
      </div>
    </section>

    <section class="doc-section doc-section-no-img" id="companion-remote">
      <div class="doc-section-body">
        <h2>伴侣应用远程访问</h2>
        <p>应用内不包含 Tailscale、Cloudflare 或 Pinggy — 由你自行暴露 Core（Tailscale、Cloudflare Tunnel、Pinggy 或 SSH 隧道），然后在应用中设置该 URL（及可选的 API Key）。应用内无 SDK；仅通过 HTTP 连接 Core。</p>
        <p><strong>分步说明：iPhone 伴侣应用 + Cloudflare Tunnel</strong> — <a href="https://allenpeng0705.github.io/HomeClaw/companion-iphone-cloudflare-tunnel/" target="_blank" rel="noopener">Companion on iPhone (Cloudflare Tunnel)</a>。<strong>macOS 权限</strong> — <a href="companion-app-macos-permissions.html" target="_blank" rel="noopener">伴侣应用（macOS 权限）</a>。</p>
      </div>
    </section>

    <div class="doc-quicklinks">
      <h2>快速链接</h2>
      <ul>
        <li><a href="docs.html#channels">渠道与伴侣（文档页）</a></li>
        <li><a href="docs.html#deploy-cloud">部署到云</a></li>
        <li><a href="https://allenpeng0705.github.io/HomeClaw/remote-access/" target="_blank" rel="noopener">远程访问（完整文档）</a></li>
        <li><a href="https://allenpeng0705.github.io/HomeClaw/companion-app/" target="_blank" rel="noopener">伴侣应用（完整文档）</a></li>
      </ul>
    </div>
  </main>

  <footer class="site-footer">
    <p>HomeClaw — 你的家，你的 AI。<a href="https://github.com/allenpeng0705/HomeClaw" target="_blank" rel="noopener">GitHub</a> · <a href="https://allenpeng0705.github.io/HomeClaw/" target="_blank" rel="noopener">文档</a> · 联系：<a href="mailto:shilei.peng@qq.com">shilei.peng@qq.com</a> · 微信：shileipeng</p>
  </footer>
</body>
</html>
